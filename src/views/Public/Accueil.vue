<template>
    <div>
          <!-- ======= Hero Section ======= -->
  <section id="hero" class="hero">
    <div class="hero_content">
      <div class="rowe gy-5" data-aos="fade-in">
        <div class="hero_content1 col-lg-6 order-2 order-lg-1  text-center text-lg-start" style="margin-bottom:auto">
          <h2>Identifiez votre entreprise</h2>
          <p>Ne ratez plus aucunes opportunités pour booster les activités de vos MPME </p>
          <div class="d-flex justify-content-center justify-content-lg-start">
            <router-link to="/sign_user_mpme" class="btn-get-started">Idenifier votre entreprise</router-link>
            <a href="https://www.youtube.com/watch?v=LXb3EKWsInQ" class="glightbox btn-watch-video d-flex align-items-center">
              <i class="bi bi-play-circle" style="color: white; position: relative;">
               
            </i>
            <span>Guide de création</span></a>
          </div>
        </div>
        <div class=" hero_image col-lg-6 order-1 order-lg-2">
          <img src="@/assets/img/accueil.jpg" class="img-fluid" alt="" data-aos="zoom-out" data-aos-delay="100">
        </div>
      </div>
    </div>
  </section>
  <!-- End Hero Section -->


  <main id="main">

<!-- ======= Présentation de la directiion Section ======= -->
<section id="about" class="about">
  <div class="container" data-aos="fade-up">

    <div class="section-header">
      <h2>Présentation de la DNMPMECL</h2>
      <p>
        Aperiam dolorum et et wuia molestias qui eveniet numquam nihil porro incidunt dolores placeat sunt id nobis omnis tiledo stran delop

      </p>
      <p>
        Aperiam dolorum et et wuia molestias qui eveniet numquam nihil porro incidunt dolores placeat sunt id nobis omnis tiledo stran delop

      </p>
    </div>

    <div class="row gy-4">
      <div class="col-lg-6">
        <h3>Objectifs et stratégies</h3>
        <img src="@/assets/img/strategie.jpg" class="img-fluid rounded-4 mb-4" alt="">
      </div>
      <div class="col-lg-6">
        <div class="content ps-0 ps-lg-5">
          <p class="fst-italic">
            Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore
            magna aliqua.
          </p>
          <ul>
            <li><i class="bi bi-check-circle-fill"></i> Ullamco laboris nisi ut aliquip ex ea commodo consequat.</li>
            <li><i class="bi bi-check-circle-fill"></i> Duis aute irure dolor in reprehenderit in voluptate velit.</li>
            <li><i class="bi bi-check-circle-fill"></i> Ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate trideta storacalaperda mastiro dolore eu fugiat nulla pariatur.</li>
          </ul>
          <p>
            Ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate
            velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident
          </p>
          <p>
            Ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate
            velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident
          </p>
        </div>
      </div>
    </div>

  </div>
</section>

 <!-- ======= Clients Section ======= -->
  

    <!-- ======= Stats Counter Section ======= -->
    <section id="stats-counter" class="stats-counter">
      <div class="container" data-aos="fade-up">

        <div class="row gy-4 align-items-center">

          <div class="col-lg-6">
            <img src="@/assets/img/business.jpg" alt="" class="img-fluid">
          </div>

          <div class="col-lg-6">

            <div class="stats-item d-flex align-items-center">
              <span data-purecounter-start="0" :data-purecounter-end="totalmpme" data-purecounter-duration="1" class="purecounter"></span>
              <p><strong>MPME crées</strong> </p>
            </div><!-- End Stats Item -->

            <div class="stats-item d-flex align-items-center">
              <span data-purecounter-start="0" :data-purecounter-end="totalPersonnelPermanent" data-purecounter-duration="1" class="purecounter"></span>
              <p><strong>Emplois crés</strong>  </p>
            </div><!-- End Stats Item -->

            <div class="stats-item d-flex align-items-center">
    
              <span data-purecounter-start="0" :data-purecounter-end="totalPersonnelPermanentFemme" data-purecounter-duration="1" class="purecounter"></span>
              <p><strong>Femmes salariés</strong> </p>
            </div><!-- End Stats Item -->
          </div>

        </div>

      </div>
    </section>
    <!-- End Stats Counter Section -->

     <!-- ======= Our Services Section ======= -->
     <section id="services" class="services sections-bg">
      <div class="container" data-aos="fade-up">

        <div class="section-header">
          <h2>Etapes de formalisation</h2>
          <p>Aperiam dolorum et et wuia molestias qui eveniet numquam nihil porro incidunt dolores placeat sunt id nobis omnis tiledo stran delop</p>
        </div>

        <div class="row gy-4" data-aos="fade-up" data-aos-delay="100">

          <div class="col-lg-4 col-md-4">
            <div class="service-item  position-relative">
              <div class="icon">
                <i class="bi bi-activity"></i>
              </div>
              <h3>Nesciunt Mete</h3>
              <p>Provident nihil minus qui consequatur non omnis maiores. Eos accusantium minus dolores iure perferendis tempore et consequatur.</p>
            </div>
          </div> 

          <div class="col-lg-4 col-md-4">
            <div class="service-item position-relative">
              <div class="icon">
                <i class="bi bi-broadcast"></i>
              </div>
              <h3>Eosle Commodi</h3>
              <p>Ut autem aut autem non a. Sint sint sit facilis nam iusto sint. Libero corrupti neque eum hic non ut nesciunt dolorem.</p>
            </div>
          </div><!-- End Service Item -->

          <div class="col-lg-4 col-md-4">
            <div class="service-item position-relative">
              <div class="icon">
                <i class="bi bi-easel"></i>
              </div>
              <h3>Ledo Markt</h3>
              <p>Ut excepturi voluptatem nisi sed. Quidem fuga consequatur. Minus ea aut. Vel qui id voluptas adipisci eos earum corrupti.</p>
            </div>
          </div>
          <!-- End Service Item -->   
        </div>

      </div>
    </section>
    <!-- End Our Services Section -->

     <!-- ======= Our Team Section ======= -->
     <section id="team" class="team" >
      <div class="container" data-aos="fade-up">

        <div class="section-header">
          <h2>Quelques résultats</h2>
          <p>Nulla dolorum nulla nesciunt rerum facere sed ut inventore quam porro nihil id ratione ea sunt quis dolorem dolore earum</p>
        </div>

        <div class="row gy-4">

          <div class="col-lg-12 col-12 mb-4">
            <div class="nav-align-top mb-4">
              <ul class="nav nav-pills mb-3" role="tablist">
                <li class="nav-item">
                  <button type="button"  class="nav-link  active" role="tab" data-bs-toggle="tab" data-bs-target="#navs-pills-top-home1" aria-controls="navs-pills-top-home1" aria-selected="true">
                    MPME par secteur d'activité
                  </button>
                </li>

                <li class="nav-item">
                  <button type="button" class="nav-link" role="tab" data-bs-toggle="tab" data-bs-target="#navs-pills-top-profile1" aria-controls="navs-pills-top-profile1" aria-selected="false">
                    MPME par région
                  </button>
                </li>
                
                <li class="nav-item">
                  <button type="button" class="nav-link" role="tab" data-bs-toggle="tab" data-bs-target="#navs-pills-top-messages11" aria-controls="navs-pills-top-messages1" aria-selected="false">
                    MPME par statut juridique
                  </button>
                </li>

              </ul>
              <div class="tab-content">
                <div class="tab-pane fade show active" id="navs-pills-top-home1" role="tabpanel">


                  <table class="table">
                    <thead class="table-light">
                      <tr>
                        <th>Secteur d'activité</th>
                        <th>MPME</th> 
                      </tr>
                    </thead>
                    <tbody class="table-border-bottom-0">
                      <tr  v-for="(secteur, index) in SecteurActiviteOptions" :key="index">
                        <td>{{ secteur.label }}</td>
            <!-- Utiliser secteurMpmeCounts pour afficher le nombre de MPME par secteur -->
            <td>{{ secteurMpmeCounts[secteur.label] || 0 }}</td>
                        
                      </tr>
                     
                    </tbody>
                  </table>



                </div>
                <div class="tab-pane fade" id="navs-pills-top-profile1" role="tabpanel">
                  <table class="table">
                    <thead class="table-light">
                     
                      <tr>
                        <th>Région</th>
                        <th>MPME</th> 
                      </tr>
                    </thead>
                    <tbody class="table-border-bottom-0">
                      <tr v-for="(region, index) in regionOptions" :key="index">
                      
                        <td>{{ region.label }}</td>
                           <!-- Utiliser regionMpmeCounts pour afficher le nombre de MPME par région -->
                           <td>{{ regionMpmeCounts[region.label] || 0 }}</td>
                      </tr>
                    
                      
                    </tbody>
                  </table>

                </div>
                <div class="tab-pane fade" id="navs-pills-top-messages1" role="tabpanel">
                  <label for="annee-select">Sélectionner une année :</label>
                  <select id="annee-select" ng-model="anneeChoisie" ng-change="updateFilter()">
                    <option value="Toutes">Toutes</option>
                    <!-- <option ng-repeat="year in yearList" value="{{year}}"> {{year}} </option> -->
                  </select>

                  <table class="table">
                    <thead class="table-light">
                      <tr >
                        <th>Statut juridique</th>
                        <th>MPME</th> 
                      </tr>
                    </thead>
                    <tbody class="table-border-bottom-0">
                      <tr v-for="(statut, index) in statutJuridiqueOptions" :key="index">
                        <td>{{ statut.label }}</td>
                           <!-- Utiliser regionMpmeCounts pour afficher le nombre de MPME par région -->
                           <td>{{ statutJuridiqueMpmeCounts[statut.label] || 0 }}</td>
                        
                      </tr>
                    
                    </tbody>
                  </table>

                </div>
                <div class="tab-pane fade" id="navs-pills-top-messages11" role="tabpanel">
                  

                  <table class="table">
                    <thead class="table-light">
                      <tr >
                        <th>Statut juridique</th>
                        <th>MPME</th> 
                      </tr>
                    </thead>
                    <tbody class="table-border-bottom-0">
                      <tr v-for="(statut, index) in statutJuridiqueOptions" :key="index">
                        <td>{{ statut.label }}</td>
                           <!-- Utiliser regionMpmeCounts pour afficher le nombre de MPME par région -->
                           <td>{{ statutJuridiqueMpmeCounts[statut.label] || 0 }}</td>
                        
                      </tr>
                    
                    </tbody>
                  </table>

                </div>

              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    <!-- End Our Team Section -->
        <!-- ======= Frequently Asked Questions Section ======= -->
        <section id="clients" class="clients" style="margin-top: -60px;">
      <div class="section-header">
        <h2>Nos partenaires</h2>
        
      </div>
      <div class="container swiper-container" data-aos="zoom-out">

        <!-- <div class="clients-slider swiper"> -->
          
          <div class="swiper-wrapper align-items-center">
            <div class="swiper-slide"><img src="@/assets/img/clients/client-1.png" class="img-fluid" alt=""></div>
            <div class="swiper-slide"><img src="@/assets/img/clients/client-2.png" class="img-fluid" alt=""></div>
            <div class="swiper-slide"><img src="@/assets/img/clients/client-3.png" class="img-fluid" alt=""></div>
            <div class="swiper-slide"><img src="@/assets/img/clients/client-4.png" class="img-fluid" alt=""></div>
            <div class="swiper-slide"><img src="@/assets/img/clients/client-5.png" class="img-fluid" alt=""></div>
            <div class="swiper-slide"><img src="@/assets/img/clients/client-6.png" class="img-fluid" alt=""></div>
            <div class="swiper-slide"><img src="@/assets/img/clients/client-7.png" class="img-fluid" alt=""></div>
            <div class="swiper-slide"><img src="@/assets/img/clients/client-8.png" class="img-fluid" alt=""></div>
          </div>
          <div class="swiper-pagination"></div>

        <!-- </div> -->

      </div>
    </section> 

</main>
<!-- End Présentation de la directiion Section -->
    </div>
</template>

<script>
import Swiper from 'swiper/bundle';
import 'swiper/swiper-bundle.css';
import  "glightbox/dist/css/glightbox.css";
import  "glightbox/dist/js/glightbox.js";
import   GLightbox from 'glightbox';



export default {
  name: 'DNPMECLAccueil',
  components: {

  },
  data() {
    return {
      totalmpme:'',
      regionMpmeCounts: {},
      regionOptions: [], // Pour stocker les données des régions
    mpmeData: [], // Pour stocker les données des MPME
    regionMpmeCounts: {}, // Pour stocker les comptes de MPME par région
    SecteurActiviteOptions: [], // Vos options de secteurs d'activité
      secteurMpmeCounts: {}, // Stockez le nombre de MPME par secteur ici
    statutJuridiqueOptions: [], // Pour stocker les options des statuts juridiques
    statutJuridiqueMpmeCounts: {}, // Pour stocker les compteurs de PME par statut juridique
    totalPersonnelPermanentFemme: 0,
      totalPersonnelPermanentHomme: 0,
      totalPersonnelPermanent: 0,


      
    };
  },
async  mounted() {
  //  await this.fetchAllMpmeOptions()
   await this.fetchRegionOptions()
  //  this.fetchSecteurActiviteOptions();
    new PureCounter();
    this.lightbox = GLightbox({ 
              selector: ".glightbox"
             });
    const swiper = new Swiper('.swiper-container', {
      speed: 400,
      loop: true,
      autoplay: {
        delay: 5000,
        disableOnInteraction: false
      },
      slidesPerView: 'auto',
      pagination: {
        el: '.swiper-pagination',
        type: 'bullets',
        clickable: true
      },
      breakpoints: {
        320: {
          slidesPerView: 2,
          spaceBetween: 40
        },
        480: {
          slidesPerView: 3,
          spaceBetween: 60
        },
        640: {
          slidesPerView: 4,
          spaceBetween: 80
        },
        992: {
          slidesPerView: 6,
          spaceBetween: 120
        }
      }
    });
   
  },



  methods: {

    async fetchAllMpmeOptions() { // Renommez la méthode pour refléter qu'elle récupère les options de pays
            try {
                await this.$store.dispatch('fetchMpmeData');
                const options = JSON.parse(JSON.stringify(this.$store.getters['getMpmeData'])); // Accéder aux options des pays via le getter
                console.log('Options des mpme:', options);
                this.items = options;
                this.totalmpme = options.length; // Utilisez "length" au lieu de "lenght"
            } catch (error) {
                console.error('Erreur lors de la récupération des options mpme :', error.message);
            }
        },

        async fetchRegionOptions() {
    try {

      await this.$store.dispatch('fetchMpmeData');
      this.mpmeData = JSON.parse(JSON.stringify(this.$store.getters['getMpmeData']));
      this.totalmpme = await this.mpmeData.length;

     await this.mpmeData.forEach(pme => {
      const personnelFemme =  pme.PersonnelPermanentFemme || 0;
      const personnelHomme = pme.PersonnelPermanentHomme || 0;
      this.totalPersonnelPermanent += personnelFemme + personnelHomme;
      this.totalPersonnelPermanentFemme += pme.PersonnelPermanentFemme || 0;
      this.totalPersonnelPermanentHomme  += pme.PersonnelPermanentHomme || 0;
    });


    await this.$store.dispatch('fetchSecteurActiviteOptions'); // Action spécifique aux secteurs d'activité
    this.SecteurActiviteOptions = JSON.parse(JSON.stringify(this.$store.getters['getsecteurActiviteOptions']));
    console.log('eeee',this.SecteurActiviteOptions );

    await this.$store.dispatch('fetchRegionOptions');
      this.regionOptions = JSON.parse(JSON.stringify(this.$store.getters['getRegionOptions']));
      console.log('Options des mpme:', this.regionOptions);

      await this.$store.dispatch('fetchStatutJuridiqueOptions');
    this.statutJuridiqueOptions = JSON.parse(JSON.stringify(this.$store.getters['getStatutJuridiqueOptions']));
    console.log('Options des mpmestaurt:', this.statutJuridiqueOptions);

    this.secteurMpmeCounts = {};
    this.regionMpmeCounts = {};
    this.statutJuridiqueMpmeCounts = {};


    this.mpmeData.forEach(pme => {
      const secteurActivite = pme.PrincipalSecteurActivite; // Assurez-vous que la propriété qui contient le secteur d'activité est correcte
      if (secteurActivite) {
        if (!this.secteurMpmeCounts[secteurActivite]) {
          this.secteurMpmeCounts[secteurActivite] = 1; // Initialisez le compteur à 1 si le secteur d'activité n'existe pas encore
        } else {
          this.secteurMpmeCounts[secteurActivite]++; // Incrémente le compteur si le secteur d'activité existe déjà
        }
      }});

     console.log('Compteurs de MPME par secteur d\'activité :', this.secteurMpmeCounts);


      this.mpmeData.forEach(pme => {
        const region = pme.Region; // Assurez-vous que la propriété qui contient la région est correcte
        if (region) {
          if (!this.regionMpmeCounts[region]) {
            this.regionMpmeCounts[region] = 1; // Initialisez le compteur à 1 si la région n'existe pas encore
          } else {
            this.regionMpmeCounts[region]++; // Incrémente le compteur si la région existe déjà
          }
        }});
        console.log('Compteurs de MPME par région :', this.regionMpmeCounts);
        this.mpmeData.forEach(pme => {
      const statutJuridique = pme.CodeStatutJuridique; // Assurez-vous que la propriété qui contient le statut juridique est correcte
      if (statutJuridique) {
        if (!this.statutJuridiqueMpmeCounts[statutJuridique]) {
          this.statutJuridiqueMpmeCounts[statutJuridique] = 1; // Initialisez le compteur à 1 si le statut juridique n'existe pas encore
        } else {
          this.statutJuridiqueMpmeCounts[statutJuridique]++; // Incrémente le compteur si le statut juridique existe déjà
        }
      }
    });

    console.log('Compteurs de PME par statut juridique :', this.statutJuridiqueMpmeCounts);
    } catch (error) {
      console.error('Erreur lors de la récupération des données :', error.message);
    }
  },

  async fetchSecteurActiviteOptions() {
  try {
    // Récupérez les données des secteurs d'activité depuis l'API
    await this.$store.dispatch('fetchSecteurActiviteOptions'); // Action spécifique aux secteurs d'activité
    this.SecteurActiviteOptions = JSON.parse(JSON.stringify(this.$store.getters['getsecteurActiviteOptions']));
    console.log('eeee',this.SecteurActiviteOptions );
    // Récupérez les données des MPME depuis l'API des MPME
    await this.$store.dispatch('fetchMpmeData');
    this.mpmeData = JSON.parse(JSON.stringify(this.$store.getters['getMpmeData']));

    // Initialisez les compteurs de MPME par secteur d'activité
    this.secteurMpmeCounts = {};

    // Parcourez les données des MPME et comptez le nombre de MPME par secteur d'activité
    this.mpmeData.forEach(pme => {
      const secteurActivite = pme.PrincipalSecteurActivite; // Assurez-vous que la propriété qui contient le secteur d'activité est correcte
      if (secteurActivite) {
        if (!this.secteurMpmeCounts[secteurActivite]) {
          this.secteurMpmeCounts[secteurActivite] = 1; // Initialisez le compteur à 1 si le secteur d'activité n'existe pas encore
        } else {
          this.secteurMpmeCounts[secteurActivite]++; // Incrémente le compteur si le secteur d'activité existe déjà
        }
      }
    });

    console.log('Compteurs de MPME par secteur d\'activité :', this.secteurMpmeCounts);
  } catch (error) {
    console.error('Erreur lors de la récupération des données :', error.message);
  }
},

async fetchStatutJuridiqueOptions() {
  try {
    // Récupérez les données des statuts juridiques depuis l'API
    await this.$store.dispatch('fetchStatutJuridiqueOptions');
    this.statutJuridiqueOptions = JSON.parse(JSON.stringify(this.$store.getters['getStatutJuridiqueOptions']));

    // Récupérez les données des PME depuis l'API des PME
    await this.$store.dispatch('fetchMpmeData');
    this.mpmeData = JSON.parse(JSON.stringify(this.$store.getters['getMpmeData']));

    // Initialisez les compteurs de PME par statut juridique
    this.statutJuridiqueMpmeCounts = {};

    // Parcourez les données des PME et comptez le nombre de PME par statut juridique
    this.mpmeData.forEach(pme => {
      const statutJuridique = pme.StatutJuridique; // Assurez-vous que la propriété qui contient le statut juridique est correcte
      if (statutJuridique) {
        if (!this.statutJuridiqueMpmeCounts[statutJuridique]) {
          this.statutJuridiqueMpmeCounts[statutJuridique] = 1; // Initialisez le compteur à 1 si le statut juridique n'existe pas encore
        } else {
          this.statutJuridiqueMpmeCounts[statutJuridique]++; // Incrémente le compteur si le statut juridique existe déjà
        }
      }
    });

    console.log('Compteurs de PME par statut juridique :', this.statutJuridiqueMpmeCounts);
  } catch (error) {
    console.error('Erreur lors de la récupération des données :', error.message);
  }
},


  },
};
</script>

<style lang="css" scoped>

</style>